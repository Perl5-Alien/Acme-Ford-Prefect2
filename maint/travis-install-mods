#!/bin/bash -x

set -euo pipefail
IFS=$'\n\t'

rm -rf /tmp/Alien-Build /tmp/Alien-Build-MB /tmp/Dist-Zilla-Plugin-AlienBuild /tmp/App-af /tmp/Acme-Ford-Prefect2

cpanm -n Dist::Zilla


git clone --depth 2 https://github.com/Perl5-Alien/Alien-Build.git /tmp/Alien-Build
cd /tmp/Alien-Build
dzil authordeps --missing | cpanm -n
dzil listdeps   --missing | cpanm -n
dzil install --install-command 'cpanm -n .'

git clone --depth 2 https://github.com/plicease/Alien-Build-MB.git /tmp/Alien-Build-MB
cd /tmp/Alien-Build-MB
dzil authordeps --missing | cpanm -n
dzil listdeps   --missing | cpanm -n
dzil install --install-command 'cpanm -n .'

git clone --depth 2 https://github.com/plicease/Dist-Zilla-Plugin-AlienBuild.git /tmp/Dist-Zilla-Plugin-AlienBuild
cd /tmp/Dist-Zilla-Plugin-AlienBuild
dzil authordeps --missing | cpanm -n
dzil listdeps   --missing | cpanm -n
dzil install --install-command 'cpanm -n .'

git clone --depth 2 https://github.com/plicease/App-af.git /tmp/App-af
cd /tmp/App-af
dzil authordeps --missing | cpanm -n
dzil listdeps   --missing | cpanm -n
dzil install --install-command 'cpanm -n .'

git clone --depth 2 https://github.com/Perl5-Alien/Acme-Ford-Prefect2.git /tmp/Acme-Ford-Prefect2
cd /tmp/Acme-Ford-Prefect2
dzil authordeps --missing | cpanm -n
dzil listdeps   --missing | cpanm -n
dzil install --install-command 'cpanm -n .'
